<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Personalized Document</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #eeeeee;
            margin: 0;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
        }
        .instructions {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .form-container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
        }
        h2 {
            margin-top: 0;
            color: #333;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .form-group input:focus {
            outline: none;
            border-color: #007bff;
        }
        button {
            width: 100%;
            padding: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="instructions">
    <p>Enter your personal details and press the link to download the Word document and open your e-mail client.</p>
    <p>Once the email client opens, you'll want to press the attachment button and attach the testimony document that just downloaded.</p>
    <p>Review the document, the subject, and the message. You can edit or delete them if you want to.</p>
    <p>When you are satisfied, tap on the send button to send your e-mail to the committee.</p>
</div>

<div class="form-container">
    <div class="form-group">
        <label for="firstName">Name:</label>
        <input type="text" id="firstName" name="firstName" required>
    </div>

    <div class="form-group">
        <label for="lastName">Business Name:</label>
        <input type="text" id="lastName" name="lastName" required>
    </div>

    <div class="form-group">
        <label for="streetAddress">Business Address:</label>
        <input type="text" id="streetAddress" name="streetAddress" required>
    </div>
    <div class="form-group">
        <label for="address">City, State and Zip Code:</label>
        <input type="text" id="address" name="address" required>
    </div>

    <button onclick="generateWordDocument()">Download Attachment and Send Email</button>
</div>

<script src="https://unpkg.com/docx@latest"></script>

<script>
function generateWordDocument() {
    const firstName = document.getElementById("firstName").value.trim();
    const lastName = document.getElementById("lastName").value.trim();
    const address = document.getElementById("address").value.trim();
    const streetAddress =  document.getElementById("streetAddress").value.trim();
    if (!firstName || !lastName || !address || !streetAddress) {
        alert("Please fill in all the fields.");
        return;
    }

     const paragraphs = [
        "_FIRSTNAME_\n_LASTNAME_\n_STREETADDRESS_\n_ADDRESS_\n_DATE_\n\n\nHouse Commerce Finance and Policy Committee\n\nDear Honorable Committee members\nAs a responsible and law-abiding small business owner in the tobacco industry, I am writing to express my strong opposition to Minnesota HF 2177, which aims to prohibit the sale or offer for sale of flavored tobacco products. I urge the committee to reconsider this proposal due to its potential adverse effects on both public health and local businesses.\nFirstly, I understand and support the state's efforts to promote public health. However, as a law-abiding retailer, I believe that prohibiting flavored tobacco products may inadvertently drive consumers towards unregulated sources or more harmful alternatives. This could undermine the very goals of public health and harm reduction that the bill seeks to achieve.\nFurthermore, our business and many others in our industry are already subject to rigorous regulations and high taxes, such as the 95% tax on all tobacco products in Minnesota. Implementing further restrictions could severely impact our livelihoods and the livelihoods of our employees. It is crucial to consider the economic repercussions on small businesses like mine before enacting such legislation.\nMoreover, flavored tobacco products constitute a significant portion of our sales, and banning them would undoubtedly result in a substantial loss of revenue. This could lead to job losses and even business closures, particularly for small businesses already facing challenges in the aftermath of the pandemic.\nIn conclusion, while I share the state's commitment to public health, I urge the committee to seek alternative solutions that prioritize both health objectives and the economic well-being of small businesses. I am ready to collaborate and support evidence-based approaches that achieve a balance between public health goals and the preservation of our industry.\nThank you for considering my perspective and the interests of small businesses like mine in your deliberations on this critical issue.\nSincerely,\n\n_FIRSTNAME_\n_LASTNAME_",
        "_FIRSTNAME_\n_LASTNAME_\n_STREETADDRESS_\n_ADDRESS_\n_DATE_\n\n\nSubject: Opposition to Minnesota HF 2177 - Prohibition of Flavored Tobacco Products\nDear Committee Members\nAs a responsible and law-abiding small business owner in the tobacco industry, I am writing to express my strong opposition to Minnesota HF 2177, a proposed bill that seeks to prohibit the sale or offer for sale of flavored tobacco products. I urge the committee to reconsider this proposal, taking into account its potential adverse effects on both public health and local businesses.\n1. Public Health Considerations:\n\nWhile I appreciate the state's commitment to promoting public health, I believe that an outright ban on flavored tobacco products may have unintended consequences. Here are some key points to consider:\n\n	 Consumer Behavior: Prohibiting flavored tobacco products could drive consumers toward unregulated sources or more harmful alternatives. It is essential to strike a balance between regulation and harm reduction to achieve the desired health outcomes.\n		Harm Reduction Goals: The bill's intention aligns with harm reduction objectives. However, we must ensure that the proposed measures do not inadvertently lead to unintended negative consequences.\n\n2. Economic Impact on Small Businesses:\n\nOur business, like many others in the industry, already operates under rigorous regulations and faces high taxes. For instance, Minnesota imposes a 95% tax on all tobacco products. Implementing further restrictions could significantly impact our livelihoods and the well-being of our employees. Small businesses need thoughtful consideration before enacting legislation that affects their operations.\n\n3. Revenue and Job Loss:\n\nFlavored tobacco products constitute a substantial portion of our sales. Banning these products would undoubtedly result in a significant revenue loss. Moreover, job losses and potential business closures would disproportionately affect small businesses, especially those still recovering from pandemic-related challenges.\n\n4. Seeking a Balanced Approach:\n\nIn conclusion, I share the state's commitment to public health. However, I encourage the committee to explore alternative solutions that achieve a balance between health objectives and economic viability for small businesses. Evidence-based approaches can help us find common ground while preserving the integrity of our industry.\n\nThank you for considering my perspective and advocating for the interests of small businesses like mine during your deliberations on this critical matter.\n\n_FIRSTNAME_\n_LASTNAME_",
        "_FIRSTNAME_\n_LASTNAME_\n_STREETADDRESS_\n_ADDRESS_\n_DATE_\n\n\nHouse Commerce Finance and Policy Committee\n\nDear Honorable Chairman Stephenson, Rep O'Driscoll and Members\n\nI am writing to express my deep concerns regarding Minnesota HF 2177, which proposes to prohibit the sale or offer for sale of flavored tobacco products. As a business owner in the tobacco industry, I urge the committee to reconsider this bill due to its potential adverse effects on revenue and commerce.\n\nImplementing a ban on flavored tobacco products would significantly impact my business and many others in the industry. Flavored products constitute a substantial portion of our sales, and the sudden prohibition would result in a substantial loss of revenue. This loss could have severe consequences for the viability of our businesses and the livelihoods of our employees.\n\nFurthermore, the interruption to commerce caused by such a ban would be detrimental to local economies. Small businesses like mine contribute to the economic vitality of our communities, and any measure that hampers our ability to operate would have ripple effects throughout the supply chain.\n\nI understand the importance of public health initiatives, but I believe there are alternative approaches that can achieve the desired outcomes without resorting to prohibition. Instead of banning flavored tobacco products outright, I urge the committee to consider implementing regulations that balance public health concerns with the economic viability of businesses like mine.\n\nIn conclusion, I urge the committee to reconsider HF 2177 and its potential impact on revenue and commerce. Let us work together to find solutions that promote public health while also supporting small businesses and local economies.\n\nThank you for considering my perspective on this important issue.\n\nSincerely,\n\n_FIRSTNAME_\n_LASTNAME_"
    ];


    const randomIndex = Math.floor(Math.random() * paragraphs.length);
    let selectedParagraph = paragraphs[randomIndex];

    selectedParagraph = selectedParagraph.replace("_FIRSTNAME_", firstName);
    selectedParagraph = selectedParagraph.replace("_LASTNAME_", lastName);
    selectedParagraph = selectedParagraph.replace("_STREETADDRESS_", streetAddress);
    selectedParagraph = selectedParagraph.replace("_ADDRESS_", address);
	selectedParagraph = selectedParagraph.replace("_FIRSTNAME_", firstName);
    selectedParagraph = selectedParagraph.replace("_LASTNAME_", lastName);
	let currentDate = new Date();
    let year = currentDate.getFullYear();
	let month = currentDate.getMonth(); 
	let day = currentDate.getDate();

    selectedParagraph = selectedParagraph.replace("_DATE_", (month+1)+"/"+day+"/"+year);


            // Assuming `docx` library is available

const { Document, Packer, Paragraph, TextRun  } = docx;





// Create a new document
const doc = new Document({
    sections: [{
        properties: {},
        children: selectedParagraph.split("\n").map(paragraphText => new Paragraph({
                children: [
                    new TextRun({
                        text: paragraphText,
                        size: 28, // Example of even smaller text (10pt)
                    }),
                ],
            })),
    }],
});

// Use Packer to create a Blob from the document
Packer.toBlob(doc).then(blob => {
    // Use the same approach as before to create a download link
    const downloadLink = document.createElement("a");
    downloadLink.href = URL.createObjectURL(blob);
    downloadLink.download = "Written Testimony in opposition of HF 2177.docx";

    document.body.appendChild(downloadLink);
    downloadLink.click();
    document.body.removeChild(downloadLink);
}).catch(err => console.error(err));


    // const fileName = "Written Testimony in opposition of HF 2177.doc";

    // const blob = new Blob([selectedParagraph], { type: "text/plain;charset=utf-8" });

    // const downloadLink = document.createElement("a");
    // downloadLink.href = URL.createObjectURL(blob);
    // downloadLink.download = fileName;

    // document.body.appendChild(downloadLink);
    // downloadLink.click();
    // document.body.removeChild(downloadLink);
	sendMail();

}
function sendMail() {

    const emailtitles =["Here is my written testimony opposing HF 2177.","I am submitting this written statement to express my opposition to HF 2177.","My written testimony outlines my objections to HF 2177."];
    const randomEamilIndex = Math.floor(Math.random() * emailtitles.length);
    let selectedEmailTitle = emailtitles[randomEamilIndex];


    var email = 'rep.zack.stephenson@house.mn.gov, rep.carlie.kotyza-witthuhn@house.mn.gov, rep.tim.odriscoll@house.mn.gov, rep.robert.bierman@house.mn.gov, rep.ethan.cha@house.mn.gov, rep.jeff.dotseth@house.mn.gov, rep.mike.freiberg@house.mn.gov, rep.ginny.klevorn@house.mn.gov, rep.erin.koegel@house.mn.gov, rep.larry.kraft@house.mn.gov, rep.tina.liebling@house.mn.gov, rep.anne.neu@house.mn.gov, rep.harry.niska@house.mn.gov, rep.bernie.perryman@house.mn.gov, rep.brian.pfarr@house.'; // The email address to send to
    var subject = encodeURIComponent(selectedEmailTitle); // The subject of the email
    var body = encodeURIComponent('Enclosed is my written testimony for inclusion in the committee\'s records.'); // The body of the email
    var bcc = 'stopmnflavorban@gmail.com'; // The BCC recipient

    // Creating the mailto link
    var mailtoLink = `mailto:${email}?bcc=${bcc}&subject=${subject}&body=${body}`;

    // Setting window.location.href to the mailto link
    window.location.href = mailtoLink;
}
</script>

</body>
</html>
